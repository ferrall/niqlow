include Makefile.inc

INC := ../include

vpath %.ox .:Shared:DDP:FiveO:Hybrids:$(INC)
vpath %.h $(INC)
vpath %.oxo $(INC)
vpath %.ox.html ../doc

oxobjects = Shared.oxo DDP.oxo FiveO.oxo CFMPI.ox Hybrids.oxo

niqlow.oxo  : $(oxobjects)

%.oxo : %.ox %.h
	$(OX) $(OXFLAGS) -i$(INC) -c $<
	$(COPY) $@ $(INC)
	$(ERASE) $@

.PHONY : clean
clean:
	$(info $(CURDIR))
	$(ERASE) *.oxo
	$(ERASE) $(INC)/*.oxo

.PHONY : document
document:
	$(ERASE) ../doc/default.html
	$(OXDOC) -uplevel -include $(INC) "niqlow is" "About niqlow"
	${MAKE} -C $(DOC) tweak
	${MAKE} -C About document
	${MAKE} -C DDP document
	${MAKE} -C FiveO document
	${MAKE} -C Hybrids document
	${MAKE} -C CFMPI document
	${MAKE} -C $(XMP) document
	
.PHONY : install
install:
	$(ERASE) $(INC)/*.oxo
	${MAKE} -C DDP
	${MAKE} -C FiveO
	$(COPY) FiveO/ParallelObjective.ox $(INC)
	${MAKE} -C Hybrids
	${MAKE} -C .
ifeq ($(OS), Windows)
	$(ERASE) $(XMP)/*.oxo
	${MAKE} -C $(XMP)
	$(ERASE) $(XMP)/PeerCommunicationTestA.oxo
	$(ERASE) $(XMP)/ClientServerTestA.oxo
endif
